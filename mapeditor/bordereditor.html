<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
		<script src="geo.js"></script>
		<script src="borders.js"></script>
		<script src="geolib.js"></script>
    <style>
      body {
        padding: 0;
        margin: 0;
      }
      text {
        font-family: 'Niconne', cursive;
      }
      svg {
				width: 2000px;
      }
      #debugwrap {
        z-index: 1;
        position: fixed;
        top: 0;
        left: 0;
        background-color: rgba(255, 255, 255, 0.9);
      }
			#canals {
				stroke-dasharray: 3 3;
				fill: transparent;
				stroke: #aaaaff;
				stroke-width: 1;
			}
			#regions path {
				fill: #eee;
			}
			#sea_regions path {
				fill: #ddf;
			}
			#regions path:hover, #sea_regions path:hover {
				fill: #ffcc00;
			}
			#borders path {
				stroke: #444444;
				stroke-width: 0.5;
				fill: transparent;
				pointer-events: none;
			}
    </style>
  </head>
  <body>
		<svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="-50 -50 1154 1300" id="svg" version="1.1">
			<!-- Patterns -->
			<g id="content">
				<g id="regions">
				</g>
				<g id="sea_regions">
				</g>
				<g id="canals">
					<path d="M195.80,115.02 L194.38,115.53 L193.08,114.77 L191.80,115.36 L190.40,115.22 L188.97,115.14 L187.79,115.93 L186.51,116.38 L185.17,116.59 L183.80,116.02 L182.38,116.44 L181.22,117.27 L179.85,117.64 L178.35,117.72 L177.09,118.54 L175.54,118.44 L174.45,117.33"></path>
					<path d="M10.58,242.54 L11.33,244.31 L11.60,246.21 L11.41,248.24 L9.93,249.64 L10.07,251.60 L8.70,253.00 L7.33,254.30 L7.04,256.17 L7.76,258.00 L7.74,259.96 L8.89,261.50 L10.01,263.08 L9.80,264.98 L8.96,266.69 L9.03,268.71 L7.70,270.23"></path>
					<path d="M45.20,1089.59 L41.98,1088.83 L39.18,1087.08 L37.36,1083.96 L33.78,1083.42 L33.10,1079.72 L29.81,1077.90 L31.25,1074.48 L29.73,1071.10 L26.80,1073.44 L23.07,1073.03 L19.90,1071.21 L16.27,1071.69 L14.91,1068.23 L14.34,1064.56 L11.67,1061.60 L7.70,1061.31"></path>
					<path d="M72.32,847.24 L74.72,847.49 L76.61,845.98 L78.22,847.84 L80.67,847.85 L83.01,848.01 L85.32,847.60 L86.43,849.72 L88.39,851.09 L88.83,853.28 L89.73,855.32 L91.76,856.44 L92.80,858.51 L94.97,859.02 L97.16,859.41 L98.21,861.64 L100.59,862.25 L100.23,864.62 L100.84,866.94 L101.92,869.17 L104.14,870.30 L103.96,872.59 L103.06,874.70 L103.12,877.02 L104.14,879.10 L104.48,881.40 L104.50,883.72 L103.41,885.84 L103.40,888.22 L105.31,889.81 L107.54,890.91 L107.89,893.36 L108.67,895.71"></path>
					<path d="M-2.10,231.00 L1.76,233.00 L3.71,236.91 L7.18,239.21 L10.27,241.99 L14.44,241.15 L18.23,239.20 L22.48,238.35 L26.65,239.52 L30.24,241.97 L34.51,241.25 L38.31,242.76 L41.33,245.52 L41.62,249.69 L43.57,253.39 L45.59,257.12 L49.24,259.27"></path>
					<path d="M157.14,78.09 L156.70,82.33 L157.56,86.50 L156.47,90.72 L157.60,94.93 L160.89,98.37 L161.23,103.12 L166.10,103.37 L169.25,107.10 L172.65,110.00 L173.42,114.41 L175.25,118.58 L173.60,122.82 L177.05,125.07 L180.31,127.59 L183.79,130.10 L185.41,134.06"></path>
					<path d="M948.78,844.36 L945.47,845.58 L943.45,848.47 L943.36,851.83 L943.42,855.20 L945.23,858.06 L946.78,861.06 L946.58,864.65 L944.13,867.28 L945.70,869.78 L947.45,872.17 L949.53,874.61 L949.23,877.80 L950.77,880.42 L953.06,882.41 L953.38,885.42 L954.55,888.21"></path>
					<path d="M810.88,853.59 L810.79,848.28 L808.29,843.58 L809.65,838.49 L812.85,834.30 L817.16,832.06 L821.23,829.40 L825.86,827.53 L829.12,823.75 L829.50,819.11 L829.92,814.47 L831.60,809.91 L830.49,805.18 L827.85,801.12 L823.71,798.60 L823.45,793.46 L819.53,790.12"></path>
					<path d="M629.70,1026.69 L631.98,1021.93 L636.82,1019.82 L642.10,1020.05 L646.22,1016.75 L651.05,1014.65 L656.22,1015.64 L661.00,1017.35 L665.20,1020.19 L668.44,1016.47 L672.72,1014.01 L677.58,1015.03 L682.46,1014.05 L684.93,1009.89 L689.45,1008.13 L693.93,1006.43 L696.63,1002.46"></path>
					<path d="M30.20,1040.54 L31.67,1042.17 L33.72,1042.94 L35.85,1042.94 L37.98,1042.94 L40.20,1042.48 L42.47,1042.45 L44.06,1044.05 L45.65,1045.65 L47.97,1045.83 L49.65,1044.22 L51.55,1045.49 L53.80,1045.12 L56.08,1044.86 L57.79,1046.40 L59.70,1045.06 L61.93,1045.73"></path>
					<path d="M267.35,387.37 L269.43,390.01 L269.69,393.37 L270.24,396.58 L269.82,399.81 L273.12,400.49 L275.61,402.77 L276.76,405.98 L279.58,407.91 L279.54,411.10 L281.25,413.79 L281.92,416.78 L283.01,419.65 L286.12,420.74 L287.87,423.53 L289.01,426.47 L291.00,428.91"></path>
					<path d="M732.98,299.66 L731.67,296.22 L731.59,292.55 L733.50,289.34 L733.70,285.61 L737.80,285.70 L741.00,283.14 L741.84,279.31 L744.01,276.04 L745.21,272.53 L746.02,268.90 L749.15,266.79 L752.82,265.93 L754.14,262.81 L755.47,259.69 L754.09,256.16 L756.06,252.92"></path>
				</g>
				<g id="borders">
					<circle id="circ" r="1" cx="-200" cy="-200"></circle>
				</g>
			</g>
		</svg>
		<div id="debugwrap">
			<textarea id="dumpArea"></textarea>
		</div>
		<script>
			geoize(false);
			function h(i, p) {
				let pp = g_regions[i].path[0][p]
				console.log(pp);
				document.getElementById("circ").setAttribute("cx", pp[0]);
				document.getElementById("circ").setAttribute("cy", pp[1]);
			}
			let borderElement = document.getElementById("borders");
			for (let b of g_borders) {
				let pe = document.createElementNS("http://www.w3.org/2000/svg", "path");
				let path = toPath(b.border);
				if (b.weight > 1) path += toPath(parallel(b.border, 1.5));
				if (b.weight > 2) path += toPath(parallel(b.border, -1.5));
				pe.setAttribute("d", path);
				pe.setAttribute("id", "borderpath_" + b.a + "_" + b.b);
				borderElement.appendChild(pe);
			}
			let prevClick = -1;
			function regionClick(id) {
				if (prevClick != -1) {
					let b = Math.min(prevClick, id);
					let a = Math.max(prevClick, id);
					for (let bo of g_borders) {
						if (bo.a == a && bo.b == b) {
							bo.weight = bo.weight % 3 + 1;
							let path = toPath(bo.border);
							if (bo.weight > 1) path += toPath(parallel(bo.border, 1.5));
							if (bo.weight > 2) path += toPath(parallel(bo.border, -1.5));
							document.getElementById("borderpath_" + a + "_" + b).setAttribute("d", path);
							id = -1;
							setTimeout(function() { document.getElementById("dumpArea").value = "g_borders = " + JSON.stringify(g_borders); }, 0);
							break;
						}
					}
				}
				console.log(prevClick, id);
				prevClick = id;
			}
			</script>
	</body>
</html>
