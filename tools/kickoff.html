<html>
	<head>
		<script src="../frontend/server.js"></script>
		<script>
			function postForm() {
				let pw = document.getElementById("gmPassword").value;
				let pw2 = document.getElementById("obsPassword").value;
				let nations = document.getElementById("nations").value.split("\n").map(x => x.trim()).filter(x => x.length > 0);
				let gameId = parseInt(document.getElementById("gameId").value);
				
				let req = new XMLHttpRequest();
				req.open("post", g_server + "/entry/startworld?gid=" + gameId, true);
				req.onerror = function (e) {
					window.alert(req.status);
				};
				req.onload = function (ev) {
					window.alert(req.status);
				};
				req.send(JSON.stringify({
					"gm_password": pw,
					"obs_password": pw2,
					"kingdoms": nations
				}));
				return false;
			}
		</script>
	</head>
	<body>
		<form onsubmit="return postForm();">
			<label>GM Password: <input id="gmPassword" type="password"/></label>
			<label>Observer Password: <input id="obsPassword" type="password"/></label>
			<label>
				Newline-Separated List of Nations:
				<textarea id="nations">
					Aefoss
					Balyucesu
					Celyn
					Doomstoll
					Ejymsyn
					Fiskrbaer
					Gangrjata
					Hosshofn
					Isla
					Jaraslatr
					Kyaradis
					Landhylli
					Mabe
					Nysiunarri
					Pernepulse
					Rettrsvelt
					Slail
					Tavia
					Upiceil
					Yrslekye
					Zemsim
				</textarea>
			</label>
			<label>Game ID: <input id="gameId" type="number"/></label>
			<button>Start!</button>
		</form>
		<div id="advances"></div>
		<script>
			for (let i = 1; i < 30; i++) {
				let f = document.createElement("form");
				f.setAttribute("action", g_server + "/entry/advanceworld?gid=0&t=" + i);
				f.setAttribute("method", "POST");
				let b = document.createElement("button");
				b.appendChild(document.createTextNode("Advance game 0 turn " + i));
				f.appendChild(b);
				document.getElementById("advances").appendChild(f);
			}
		</script>
	</body>
</html>
